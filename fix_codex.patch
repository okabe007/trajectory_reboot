diff --git a/core/simulation.py b/core/simulation.py
index 4ba0923..2133aa7 100644
--- a/core/simulation.py
+++ b/core/simulation.py
@@ -430,50 +430,61 @@ class SpermSimulation:
                             bottom_z = self.constants["spot_bottom_height"]
                             step_vec = vec * step_len
                             if abs(step_vec[2]) < 1e-12:
                                 proj = step_vec.copy()
                                 proj[2] = 0.0
                                 norm = np.linalg.norm(proj)
                                 if norm < 1e-12:
                                     proj = np.array([1.0, 0.0, 0.0]) * step_len
                                     norm = step_len
                                 candidate = pos + proj / norm * step_len
                                 vec = proj / norm
                             else:
                                 t = (bottom_z - pos[2]) / step_vec[2]
                                 t = max(0.0, min(1.0, t))
                                 intersect = pos + step_vec * t
                                 remain = step_len * (1.0 - t)
                                 proj_dir = vec.copy()
                                 proj_dir[2] = 0.0
                                 norm = np.linalg.norm(proj_dir)
                                 if norm < 1e-12:
                                     proj_dir = np.array([1.0, 0.0, 0.0])
                                     norm = 1.0
                                 proj_dir /= norm
                                 candidate = intersect + proj_dir * remain
                                 vec = (candidate - pos) / step_len
+
+                    disp_len = np.linalg.norm(candidate - pos)
+                    max_len = step_len
+                    if disp_len > max_len * 1.05:
+                        print(
+                            f"[ERROR] displacement {disp_len} mm exceeds "
+                            f"step_length {max_len} mm at rep={rep}, sperm={i}, step={j}"
+                        )
+                        print(f"pos={pos}, candidate={candidate}, vec={vec}")
+                        raise RuntimeError("step length exceeded")
+
                     pos = candidate
                     traj.append(pos.copy())
                     if shape == "spot":
                         prev_states[i] = status
                         if bottom_modes[i]:
                             if stick_statuses[i] > 0:
                                 stick_statuses[i] -= 1
                             if stick_statuses[i] == 0:
                                 bottom_modes[i] = False
 
                     if rep == 0 and i == 0 and j == 0:
                         print(f"[DEBUG] 1step_disp(mm) = {np.linalg.norm(vec*step_len):.5f}")
 
                 self.trajectory.append(np.vstack(traj))
 
         print(f"[DEBUG] run完了: sperm={len(self.trajectory)}, steps={number_of_steps}, "
               f"step_len={step_len} mm")
 
 
 
     import matplotlib.pyplot as plt
 
     def plot_trajectories(self, max_sperm=5, save_path=None):
         """
         インスタンスのself.trajectory（リスト of N×3 配列）を可視化
