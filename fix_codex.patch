diff --git a/tools/derived_constants.py b/tools/derived_constants.py
index fe1b703762467cf5892e30295a506b82af68d8ca..6b7d461746d9f0e49d10ec7c4c13190c43a63cb8 100644
--- a/tools/derived_constants.py
+++ b/tools/derived_constants.py
@@ -23,36 +23,45 @@ def calculate_derived_constants(constants: Dict[str, float]) -> Dict[str, float]
         r_raw = float(constants["drop_r"])
         constants["drop_r"] = r_raw / 1_000.0 if r_raw > 10 else r_raw
         constants.setdefault("radius", constants["drop_r"])
 
     if "spot_r" in constants:
         r_raw = float(constants["spot_r"])
         constants["spot_r"] = r_raw / 1_000.0 if r_raw > 10 else r_raw
         constants.setdefault("radius", constants["spot_r"])
 
     if "spot_bottom_height" in constants:
         b_raw = float(constants["spot_bottom_height"])
         constants["spot_bottom_height"] = b_raw / 1_000.0 if b_raw > 10 else b_raw
 
     if "spot_bottom_r" in constants:
         br_raw = float(constants["spot_bottom_r"])
         constants["spot_bottom_r"] = br_raw / 1_000.0 if br_raw > 10 else br_raw
 
     # ---------- 共通パラメータ ------------------------------------------
     constants.update(
         vsl=vsl,
         step_length=vsl / hz if hz else 0.0,
         limit=1e-9,
         gamete_r=gamete_r,
     )
 
+    # number_of_sperm を濃度と体積から計算（µL→mL 換算）
+    if "vol" in constants and "sperm_conc" in constants:
+        try:
+            vol_ul = float(constants["vol"])
+            conc = float(constants["sperm_conc"])
+            constants["number_of_sperm"] = int(conc * vol_ul / 1000)
+        except Exception:
+            pass
+
     return constants
 
 
 # ------------------------------------------------------------
 # plot_utils.py 用の軽量ヘルパー --------------------------------
 # ------------------------------------------------------------
 def get_limits(constants: Dict[str, float]) -> Tuple[float, float, float, float, float, float]:
     """x/y/z 各軸の min・max（mm）を tuple で返す"""
     return (constants["x_min"], constants["x_max"],
             constants["y_min"], constants["y_max"],
             constants["z_min"], constants["z_max"])
